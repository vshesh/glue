var Anatomy = {
    view: function() {
      return m('div', m('h1', m('a', 'Anatomy of an Element')), m('p', 'Here you can learn all about the common ways to write an ', m('code', {}, 'Element'), '.'), m('p', 'This article is structured by first giving you the full list of available options, followed by some "case studies" into\nhow some of the components of the standard library were written and how you might write your own.'), m('p', 'Here is a template for the definition of an Element (hover over numbers in left gutter for more info):'), m.component(AnnotatedCode, {'code': "@asset_url(AssetType.JS, 'http://example.com/asset.js')\n@asset_inline(AssetType.CSS, '.element {property: value}')\n@block(opts='xy:')\ndef Element(text: str, x: bool=false, y: str=''):\n  return ['div', text]", 'language': 'python', 'annotations': {0: 'Some assets are loaded over the network - you can define them with\nthis decorator.\n', 1: 'Other assets (mostly CSS) are small snippets that you can just embed\ndirectly into the definition. For a more programmatic way to define\ncss properties, see [`glue/css.py`](https://github.com/vshesh/glue/blob/master/glue/css.py).\n', 2: 'You have many options for what kind of element you are dealing with,\nlook at the Cheatsheet below for a list of all of them.\n', 3: 'Blocks take the contents as their first (and only) mandatory argument, and\nthen any further options that are allowed.\n'}}), m('h2', m('a', 'Cheatsheet')), m('p', 'For all the options you have at your fingertips. You diabolical genius, you.'), m('h3', m('a', m('code', {}, 'Inline'))), m('p'), m('h4', m('a', m('code', {}, 'IdenticalInline(name: str, s: str, tag: str, attr: dict)'))), m('p', 'The most basic kind of ', m('code', {}, 'Inline'), ' Element looks like:'), m('pre', m('code#dec53720-bbb9-4c18-ab3a-25ca5907aabc.language-python', '[SOMETHING]text[SOMETHING]\nEg:\n*text*\n_text_\n__text__\n'), m('script', {'key': 'dec53720-bbb9-4c18-ab3a-25ca5907aabc'}, "hljs.highlightBlock(document.getElementById('dec53720-bbb9-4c18-ab3a-25ca5907aabc'))")), m('p', "\nIt's some character(s) followed by the contents, followed by the SAME character(s) again. The resultant HTML looks like\n", m('code', {}, '<tag ...attrs>text</tag>'), '. As you can imagine, configuring this is as easy as choosing the tag you want and the associated styles.'), m('p', 'Poster children for this type of inline element are ', m('code', {}, 'Bold'), ' (*text*), ', m('code', {}, 'Italic'), ', ', m('code', {}, 'Underline'), ', ', m('code', {}, 'Monospace'), ', ', m('code', {}, 'Strikethrough'), ",\nthe most basic styles in text editing. Here is how they're made:"), m('pre', m('code#f4c4b9be-9ac7-4a74-989b-250b5de13853.language-python', "Bold = IdenticalInline('bold', '*', 'strong')\nItalic = IdenticalInline('italic', '_', 'em')\nMonospace = IdenticalInline('monospace', '`', 'code')\nUnderline = IdenticalInline('underline', '__', 'span', {'style': 'text-decoration:underline;'})\nStrikethrough = IdenticalInline('strikethrough', '~', 'del')\n"), m('script', {'key': 'f4c4b9be-9ac7-4a74-989b-250b5de13853'}, "hljs.highlightBlock(document.getElementById('f4c4b9be-9ac7-4a74-989b-250b5de13853'))")), m('p', "\nLet's say you want to add a new element in this vein - HTML5 has a ", m('code', {}, '<sup>'), ' (superscript) tag, and you want to include\nthat syntax. You would like superscript text to look like this in your input: ', m('code', {}, '^text^'), '. How do you write the component to make this happen?'), m('pre', m('code#10070d51-f129-4fc8-962e-ad799d4a7342.language-python', "Superscript = IdenticalInlineFrame('superscript', '^', 'sup')\n"), m('script', {'key': '10070d51-f129-4fc8-962e-ad799d4a7342'}, "hljs.highlightBlock(document.getElementById('10070d51-f129-4fc8-962e-ad799d4a7342'))")), m('p', "\nThat's all, folks! Now you can type ", m('code', {}, '^superscript^'), ' and it will be converted just the way you want.'), m('h4', m('a', m('code', {}, 'MirrorInline(name:str, start:str, tag:str, attr: dict)'))), m('p', 'A slightly more general case of ', m('code', {}, 'IdenticalInlineFrame'), ' for when you want the same thing to start and end your element,\njust flipped. This element will flip ', m('code', {}, '(), [], {}, <>'), ' pairs in the start string to compute what the end string should look like.'), m('p', 'Critic Markup allows you to highlight text using the syntax ', m('code', {}, '{==text==}'), '. How would you write this?'), m('pre', m('code#be2c66a1-ab74-4fab-87eb-926f28e25ef4.language-python', "CriticMark = MirrorInline('critic-mark', '{==', 'mark')\n"), m('script', {'key': 'be2c66a1-ab74-4fab-87eb-926f28e25ef4'}, "hljs.highlightBlock(document.getElementById('be2c66a1-ab74-4fab-87eb-926f28e25ef4'))")), m('p', '\nAnd it ', m('mark', {}, 'works'), ', too!'), m('h4', m('a', m('code', {}, 'SingleGroupInline(name: str, start: str, end: str, tag: str, attr: dict)'))), m('p', 'A slightly more general version of ', m('code', {}, 'Identical/MirrorInline'), ', this allows you to do the same thing, but with different ', m('code', {}, 'start'), ' and ', m('code', {}, 'end'), ' characters.'), m('p', "Eg, let's say you want to modify the superscript element above so it looks like Latex (", m('code', {}, '^{superscript}'), '). How would you do that?'), m('pre', m('code#2458c67e-1176-43f3-9008-a9a7ea19ba43.language-python', "Superscript = SingleGroupInlineFrame('superscript', '^{', '}', 'sup')\n"), m('script', {'key': '2458c67e-1176-43f3-9008-a9a7ea19ba43'}, "hljs.highlightBlock(document.getElementById('2458c67e-1176-43f3-9008-a9a7ea19ba43'))")), m('p', "\nWhile we're at it, why not throw in subscript, too?"), m('pre', m('code#cacc331b-6a1b-4b48-bd98-cad79be3fd7a.language-python', "Subscript = SingleGroupInlineFrame('subscript', '_{', '}', 'sub')\n"), m('script', {'key': 'cacc331b-6a1b-4b48-bd98-cad79be3fd7a'}, "hljs.highlightBlock(document.getElementById('cacc331b-6a1b-4b48-bd98-cad79be3fd7a'))")), m('p', '\nWhen you implement these elements, they look like', m('sup', {}, 'this'), ' and', m('sub', {}, 'this'), '!\nHere is the chemical formula for glucose: C', m('sub', {}, '6'), 'H', m('sub', {}, '12'), 'O', m('sub', {}, '6'), '.'), m('h4', m('a', m('code', {}, '@inline_one(start: str, end: str)'))), m('p', 'General purpose element for ', m('code', {}, 'Inline'), ' elements that only capture one group.\nStart and end are for the text that goes before and after the capture group, respectively.'), m('p', 'For example, markdown allows you to put a link in place by surrounding it with angle brackets. Eg, ', m('code', {}, '<google.com>'), '.\nHow do you add this syntax to GLUE?'), m('pre', m('code#c8ecd0a9-508e-461f-b276-7a5367a8323c.language-python', "@inline_one('<', '>')\ndef LinkInPlace(groups):\n  return ['a', {'href': groups[0]}, groups[0]]\n"), m('script', {'key': 'c8ecd0a9-508e-461f-b276-7a5367a8323c'}, "hljs.highlightBlock(document.getElementById('c8ecd0a9-508e-461f-b276-7a5367a8323c'))")), m('h4', m('a', m('code', {}, '@link(designation: str, nest=Nesting.POST, sub=None)'))), m('p', 'For elements that take on the syntax of a markdown link, preceded by some characters (', m('code', {}, 'designation'), ').\nFor example, you can copy Markdown for ', m('code', {}, '<img>'), ' tags by doing:'), m('pre', m('code#a5d48311-6d80-4c86-9fd6-c8b2a6a270f2.language-python', "@link('!') # so the syntax is ![alt](url)\ndef Image(groups):\n  return ['img', {'alt': groups[0]}, groups[1]]\n"), m('script', {'key': 'a5d48311-6d80-4c86-9fd6-c8b2a6a270f2'}, "hljs.highlightBlock(document.getElementById('a5d48311-6d80-4c86-9fd6-c8b2a6a270f2'))")), m('p', '\n', m('code', {}, 'Link'), ' itself is implemented this way:'), m('pre', m('code#400b3c98-0fd1-41e0-a7db-48a07224ea29.language-python', "@link('') # so the syntax is [text](url)\ndef Link(groups):\n  return ['a', {'href': groups[1]}, groups[0]]\n"), m('script', {'key': '400b3c98-0fd1-41e0-a7db-48a07224ea29'}, "hljs.highlightBlock(document.getElementById('400b3c98-0fd1-41e0-a7db-48a07224ea29'))")), m('p', '\nThere are others, like ', m('code', {}, 'Tooltip'), " that benefit from this syntax. Basically, if you want two capture groups in your inline\nelement, and you don't want to deal with the fuss of ", m('code', {}, '@inline_two'), ' (which is coming up), you can just use ', m('code', {}, '@link'), " with\nsome designation that isn't taken yet."), m('h4', m('a', m('code', {}, "@inline_two(start: str, mid: str, end: str, nest=Nesting.POST, sub=['all'])"))), m('p', 'A more flexible version of ', m('code', {}, '@link'), ' that allows you to delimit two groups in an inline syntax with whatever you want\nin between. Your syntax will look like: ', m('code', {}, '[start]group1[mid]group2[end]')), m('p', 'You could, for example, implement ', m('code', {}, 'Link'), ' from above like this: ', m('code', {}, "@inline_two('", m('a', {'href': "', '"}, "', '"), "')"), " (this is not how it's actually\nimplemented). Another component that can be implemented this way is ", m('code', {}, 'CriticSub'), ', which has the syntax ', m('code', {}, [m('del', 'group1'),m('ins', 'group2')]), '.'), m('h4', m('a', m('code', {}, "@inline(regex, nest=Nesting.FRAME, sub=None, escape='', display=Display.INLINE)"))), m('p', 'In case your syntax does not fit the above cases, you can define a base ', m('code', {}, 'Inline'), ' element with this decorator:'), m('pre', m('code#b805621b-8f11-4bdd-ab5e-0f45ffb3930e.language-python', '# So the syntax would be: `#id.class1.class2[wrapped text]`\n# please note that in reality, you would need to handle escapes in the regex, which isn\'t done here.\n@inline(r\'(?:\\#\\([a-z0-9_-]+?))?(?:(\\.[a-z0-9_-]+?))*[(.+?)\\]\')\ndef WrappedClass(groups):\n  """\n  Wraps the contents of the brackets in a `<span>` element with the given ids and classes.\n\n  Eg: `#id.class1.class2[wrapped text]` -> `<span id="id" class="class1 class2">wrapped text</span>`\n  """\n  return [\'span\',\n          {id: groups[0] if groups[0][0] != \'.\' else "",\n           class: \' \'.join(x.lstrip(\'.\') for x in groups[(0 if groups[0][0] == \'.\' else 1):-1]) },\n          groups[-1]]\n'), m('script', {'key': 'b805621b-8f11-4bdd-ab5e-0f45ffb3930e'}, "hljs.highlightBlock(document.getElementById('b805621b-8f11-4bdd-ab5e-0f45ffb3930e'))")), m('p', '\nThe element above creates a syntax for wrapping some text with an arbitrary HTML id and/or class. It has an\narbitrary number of capture groups (which is why ', m('code', {}, 'Inline'), " elements take the whole array of groups) and therefore doesn't\nfit any of the previous patterns. A good catch-all element if you want to expose the ability to style text in whatever\nway the content writer wants."), m('p', "For all elements that don't fit into any of the above boxes, you can just use ", m('code', {}, '@inline'), '.'), m('h3', m('a', 'Block')), m('p'), m('h4', m('a', m('code', {}, "@standalone_integration(inner_elem='div', outer_elem='div')"))), m('p', 'A special ', m('code', {}, 'Block'), ' for super easy integration of syntax that have js libraries, and have an output that looks like:'), m('pre', m('code#5ddcaf7a-7ad9-4424-bfe6-29ff01778c02.language-python', "# f = the wrapped function that you provide.\n['{outer_elem}.element-name',\n  ['{inner_elem}#element-name-1231-203-13901239'],\n  ['script', {'key': docid}, f(text, docid=docid, elem=elem)]]\n"), m('script', {'key': '5ddcaf7a-7ad9-4424-bfe6-29ff01778c02'}, "hljs.highlightBlock(document.getElementById('5ddcaf7a-7ad9-4424-bfe6-29ff01778c02'))")), m('p', '\nIn other words, there is an empty tag (', m('code', {}, 'inner_elem'), ')\nand a small script that injects the content into that tag. The whole assembly\nis wrapped in the ', m('code', {}, 'outer_elem'), '. You can specify your own ', m('code', {}, 'inner_elem'), ' and ', m('code', {}, 'outer_elem'), " in the decorator yourself,\nif you'd like. This is one element helper which may be easier to understand by just inspecting the source directly."), m('p', 'The input to this function is ', m('strong', {}, 'NOT'), " the regular parser function - it's a function that takes three variables\n(body text, docid, elem), and spits out a string that is JS that will cause the creation of the element. Here's an\nexample, the ", m('code', {}, 'Katex'), ' element:'), m('pre', m('code#5f6c8126-d949-4264-a4f2-1b24429e31d4.language-python', '@standalone_integration()\ndef Katex(text, docid, elem):\n  """Integration with Khan Academy\'s math typsetting library.\n  Takes just the body text (which is the math) and renders it in place using\n  the API of the library.\n  """\n  return repr("katex.render(\'\\\\displaystyle{{{0}}}\', {1})".format(text.strip(), elem))[1:-1]\n'), m('script', {'key': '5f6c8126-d949-4264-a4f2-1b24429e31d4'}, "hljs.highlightBlock(document.getElementById('5f6c8126-d949-4264-a4f2-1b24429e31d4'))")), m('p', '\n', m('code', {}, 'text'), ' is the contents of the body of the block when it was invoked. ', m('code', {}, 'docid'), ' is a string like ', m('code', {}, 'katex-12308-13918-1392813'), '\nwhich is the id attribute of the inner element, and ', m('code', {}, 'elem'), ' is the ', m('code', {}, 'docid'), ' wrapped with a ', m('code', {}, 'document.getElementById()'), " call.\nYou don't need to use all of them, but they're there in case you want to use them for some reason. Most integrations\nwill only need the element and the contents."), m('h4', m('a', m('code', {}, '@terminal_block(opts: str)'))), m('p', 'Some blocks do not have anything inside them, and therefore do not require any special formatting. Examples are the\nintegration type blocks for sure (Katex, musicalabc, Code, etc), but also some others, like ', m('code', {}, 'YamlComponent'), " that aren't\nintended to have any further elements inside them. Mostly ", m('code', {}, '@terminal_blocks'), ' happen when delegating to another\nplain-text syntax inside a ', m('code', {}, 'Block'), '.'), m('p', 'The only configuration left is the ', m('code', {}, 'opts'), ' if there are any opts accepted by your block.'), m('h4', m('a', m('code', {}, '@block(nest: Nesting, sub: [str], opts: str)'))), m('p', 'Catch all decorator for a ', m('code', {}, 'Block'), ' element, allows you to specify the nesting, sub, and accepted options.'), m('pre', m('code#9e323a67-cd6b-4648-b9a7-09840ff360b3.language-python', "@block(nest=Nesting.SUB)\ndef NoopBlock(text):\n  return ['div', text]\n"), m('script', {'key': '9e323a67-cd6b-4648-b9a7-09840ff360b3'}, "hljs.highlightBlock(document.getElementById('9e323a67-cd6b-4648-b9a7-09840ff360b3'))")), m('p', '\nHere is one block that is just a noop. It just wraps its contents in a div.'), m('h2', m('a', 'Add some assets')), m('p', 'Assets are snippets of CSS and JS that make life interesting for our components. Adding them to any ', m('code', {}, 'Element'), ' is really easy:'), m('h3', m('a', m('code', {}, '@asset_url(type: AssetType, url: str)'))), m('p', "Say you are writing a component to display math (using Katex) - only one problem: you need the math library! It's\nlocated ", m('em', {}, 'somewhere'), ' on the internet, so we can just add the asset as a URL:'), m('pre', m('code#d16eb4e9-2de5-4afa-bbde-3ca537c61231.language-python', "from elements import asset_url, standalone_integration, AssetType\n\n@asset_url(AssetType.CSS, '//cdnjs.com/katex/0.6.0/katex.min.css')\n@asset_url(AssetType.JS, '//cdnjs.com/katex/0.6.0/katex.min.js')\n@standalone_integration()\ndef Katex(contents, docid, elem):\n  return repr('katex.render(... blah blah ...)'.format(contents, elem)\n"), m('script', {'key': 'd16eb4e9-2de5-4afa-bbde-3ca537c61231'}, "hljs.highlightBlock(document.getElementById('d16eb4e9-2de5-4afa-bbde-3ca537c61231'))")), m('p', '\nDone! Now Katex is bundled with the necessary assets. In fact, this is pretty much exactly how ', m('code', {}, 'Katex'), ' looks in ', m('code', {}, 'library.py'), '.'), m('h3', m('a', m('code', {}, '@asset_inline(type: AssetType, contents: str)'))), m('p', 'Sometimes you just need a quick style or two that would be a pain to keep track of in other places, like your application style sheets.\nYou can just add them inline, like so:'), m('pre', m('code#3f703f4d-66fd-47a5-988d-0d24c093a995.language-python', "from elements import asset_url, standalone_integration, AssetType\n\n# This line right here:\n@asset_inline(AssetType.CSS, '.katex{ position: relative}')\n@asset_url(AssetType.CSS, '//cdnjs.com/katex/0.6.0/katex.min.css')\n@asset_url(AssetType.JS, '//cdnjs.com/katex/0.6.0/katex.min.js')\n@standalone_integration()\ndef Katex(contents, docid, elem):\n  return repr('katex.render(... blah blah ...)'.format(contents, elem)\n"), m('script', {'key': '3f703f4d-66fd-47a5-988d-0d24c093a995'}, "hljs.highlightBlock(document.getElementById('3f703f4d-66fd-47a5-988d-0d24c093a995'))")), m('p', "\nThis way you can see the whole of the component in one place. There's no need to run around looking for where to change something."));
    }
  };
  
